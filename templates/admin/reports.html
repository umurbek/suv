{% extends 'base.html' %}

{% block content %}
<div class="px-6 py-6">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">Moliyaviy Hisobotlar</h2>

    <!-- Top metric cards -->
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
        <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-500">Jami Daromad (Oylik)</p>
            <p class="text-2xl md:text-3xl font-extrabold text-blue-600">25.6M</p>
            <p class="text-xs text-gray-400">21% o'sish</p>
        </div>
        <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-500">Sof foyda</p>
            <p class="text-2xl md:text-3xl font-extrabold text-green-600">12.4M</p>
            <p class="text-xs text-gray-400">+400 (22%)</p>
        </div>
        <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-500">Xarajatlar</p>
            <p class="text-2xl md:text-3xl font-extrabold text-red-500">8.2M</p>
            <p class="text-xs text-gray-400">Transport va ish haqi</p>
        </div>
    </div>

    <!-- Chart block -->
    <div class="bg-white p-6 rounded-lg shadow">
        <h3 class="text-lg font-semibold mb-4">Jami daromad (Oyma-oy, 12 oy)</h3>
        <div class="h-72 md:h-96">
            <canvas id="reportChart"></canvas>
        </div>
    </div>

</div>

{% block extra_scripts %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // embed revenue data passed as JSON strings from the view
    const ctx = document.getElementById('reportChart');
    if (ctx) {
        const labels = JSON.parse('{{ revenue_labels_json|escapejs }}') || [];
        const data = JSON.parse('{{ revenue_data_json|escapejs }}') || [];
        new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Daromad',
                    data: data,
                    borderColor: 'rgba(37,99,235,1)',
                    backgroundColor: 'rgba(37,99,235,0.08)',
                    fill: true,
                    tension: 0.2,
                    pointRadius: 2,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true } }
            }
        });
    }
</script>
{% endblock %}

{% endblock %}
